#!/usr/bin/env bash

apt-get update --assume-yes --quiet=2
apt-get dist-upgrade --assume-yes --quiet=2
apt-get install -assume-yes --quiet=2  curl git byobu make libxml2-dev libxslt1-dev postgresql tomcat7 maven openjdk-7-jdk openjdk-7-jre openjdk-7-jre-headless

mkdir -p /opt/devoxx/
chown vagrant /opt/devoxx/

mkdir -p /home/vagrant/.ssh/
chmod 700 /home/vagrant/.ssh

echo "|1|/HidWCdUN4tO8uRm0UA50A3+FUM=|dR7zUl95JSFE6SFT6Zm7lUTclng= ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAubiN81eDcafrgMeLzaFPsw2kNvEcqTKl/VqLat/MaB33pZy0y3rJZtnqwR2qOOvbwKZYKiEO1O6VqNEBxKvJJelCq0dTXWT5pbO2gDXC6h6QDXCaHo6pOHGPUy+YBaGQRGuSusMEASYiWunYN0vCAI8QaXnWMXNMdFP3jHAJH0eDsoiGnLPBlBp4TNm6rYI74nMzgz3B9IikW4WVK+dc8KZJZWYjAuORU3jc1c/NPskD2ASinf8v3xnfXeukU0sJ5N6m5E8VLjObPEO+mN2t/FZTMZLiFqPWc/ALSqnMnnhwrNi2rbfg/rd/IpL8Le3pSBne8+seeFVBoGqzHM9yXw==" > /home/vagrant/.ssh/known_hosts
echo "|1|IX1CNjXLGlzN/Qo+D+WXSqqHmuI=|qzk5yCCBbUOiBCaJpnSQ6ujx5G4= ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAubiN81eDcafrgMeLzaFPsw2kNvEcqTKl/VqLat/MaB33pZy0y3rJZtnqwR2qOOvbwKZYKiEO1O6VqNEBxKvJJelCq0dTXWT5pbO2gDXC6h6QDXCaHo6pOHGPUy+YBaGQRGuSusMEASYiWunYN0vCAI8QaXnWMXNMdFP3jHAJH0eDsoiGnLPBlBp4TNm6rYI74nMzgz3B9IikW4WVK+dc8KZJZWYjAuORU3jc1c/NPskD2ASinf8v3xnfXeukU0sJ5N6m5E8VLjObPEO+mN2t/FZTMZLiFqPWc/ALSqnMnnhwrNi2rbfg/rd/IpL8Le3pSBne8+seeFVBoGqzHM9yXw==" >> /home/vagrant/.ssh/known_
hosts

echo "-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----" > /home/vagrant/.ssh/id_rsa

chown -R vagrant:vagrant /home/vagrant/.ssh
chmod 600 /home/vagrant/.ssh/id_rsa

cd  /opt/devoxx/
[ ! -d /opt/devoxx/perfuniversity ] && git clone git@bitbucket.org:henri_tremblay/perfuniversity.git

reboot
